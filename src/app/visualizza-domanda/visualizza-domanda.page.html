<ion-header>
  <ion-toolbar>
    <ion-button  (click)="goback()" slot="start" expand="block" fill="clear" class="msg-btn">
      <ion-icon  color="primary" slot="start" slot="icon-only" name="arrow-back-outline"></ion-icon>
    </ion-button>
      <ion-title *ngIf="currentMailUser===domandaMailUser">La tua domanda</ion-title>
      <ion-title  *ngIf="currentMailUser!==domandaMailUser">Dettagli della domanda</ion-title>
  </ion-toolbar>
</ion-header>



<ion-content *ngIf="allVisible" >
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <ion-fab  *ngIf="currentMailUser !== domandaMailUser"  vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button  (click) = "setRispostaVisible()">
      <ion-icon *ngIf="rispostaVisible === false" name="add"></ion-icon>
      <ion-icon *ngIf="rispostaVisible === true" name="close"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <ion-card class = "backgrounds">    
 

    <ion-card-header>
      <ion-toolbar class="backgrounds">

            <ion-icon   class = "alarm_style" name="alarm-outline" slot= "start"></ion-icon>
            <ion-label  class = "textTitle">{{timerView}}</ion-label>
            <ion-button slot="end" expand="block" *ngIf="currentMailUser===domandaMailUser" (click) = "popUpEliminaDomanda()" fill="clear">
              <ion-icon name="trash-sharp" color="primary" class = "icons_generic_style"></ion-icon>
            </ion-button>
           <ion-button slot="end" *ngIf="currentMailUser===domandaMailUser" (click) ="  goModificaDomanda() " expand="block" fill="clear">
              <ion-icon name="hammer-sharp" color="primary" class = "icons_generic_style"></ion-icon>
           </ion-button>
         <!--    <ion-label slot="end" class="textTitleSMALL">  Risposte totali: 
              <ion-label slot="end" class="textTitleSMALL">2</ion-label>
            </ion-label> -->
            
      </ion-toolbar>
      <ion-toolbar class="backgrounds" *ngIf="currentMailUser!==domandaMailUser">
        <ion-avatar  slot="start" class="icon-avatar" >
          <img src="https://i.ytimg.com/vi/mCf6UGT3HrA/maxresdefault.jpg">
        </ion-avatar>
        <ion-label class = "username_text_style">{{profiloUserDomanda.username}}</ion-label>

      </ion-toolbar>
      <ion-card-title class = "textTitleBIG"> {{titoloView}}</ion-card-title>
    </ion-card-header>



    <ion-card-content>
        <p class= "textSimple">{{descrizioneView}}</p>
     
          <ion-toolbar>
              <ion-icon name="calendar-outline" slot = start class = "calendar_icon_style"></ion-icon>
              <ion-label class= "description_text" slot = "start" >{{dataeoraView}}</ion-label>
              <ion-icon name="list" slot = "start"  class = "icon_list_style"></ion-icon>
              <ion-label class= "description_text" slot = "start" >{{categoria}}</ion-label>
               

          </ion-toolbar>
    </ion-card-content>
  </ion-card>


  


  <ion-card *ngIf="risposte.length === 0" class = "backgrounds">    
    <ion-card-header>
      <ion-card-title class = "textTitleBIG"> 
          <ion-label *ngIf="risposte.length === 0 && currentMailUser===domandaMailUser" class = "textSimple">Non ci sono ancora risposte alla tua domanda</ion-label>
          <ion-label *ngIf="risposte.length === 0  && currentMailUser!==domandaMailUser" class = "textSimple">Non ci sono ancora risposte per questa domanda. Rispondi per primo!</ion-label>
      </ion-card-title>
    </ion-card-header>


  </ion-card>

     <ion-item-divider color = "none" *ngIf="risposte.length !== 0" class = "textTitle">
      <ion-label  class = "textTitle"><b>Risposte ({{risposte.length}})</b></ion-label>
     </ion-item-divider>
        
         
        <ion-card *ngFor="let risposta of risposte; let i = index" class = "backgrounds">    
          <ion-card-header>
            <ion-toolbar class="backgrounds">
              <ion-avatar  slot="start" class="icon-avatar" >
                <img src="https://avatars3.githubusercontent.com/u/14333644?s=460&u=c6cf7b831fd7afd92292677dc5543c858e1e05a8&v=4">
              </ion-avatar>
              <ion-label *ngIf="currentMailUser!==risposta.cod_utente" class = "username_text_style">{{profiliUtentiRisposte[i]['0'].username}}</ion-label>
              <ion-label *ngIf="currentMailUser===risposta.cod_utente " class = "username_text_style">Tu</ion-label>
             
             
              <ion-button *ngIf="likes[i] === -1 || likes[i] === 2" class= "buttonLikes" (click)="modificaLike(risposta.codice_risposta, i)"  slot="end" expand="block" fill = "clear">
                <ion-label slot = "end" class = "textTitleSMALL">{{risposta.num_like}}</ion-label>
                <ion-icon name="chevron-up-circle-outline" class="thumb_up_style" slot= "end" ></ion-icon>
              </ion-button>


              <!--pulsante del like attivato -->
              <ion-button *ngIf="likes[i] === 1"  class= "buttonLikes" (click)="modificaLike(risposta.codice_risposta, i)"  slot="end" expand="block" fill = "outline">
                <ion-label slot = "end" class = "textTitleSMALL" >{{risposta.num_like}}</ion-label>
                <ion-icon name="chevron-up-circle-outline" class="thumb_up_style" slot= "end" ></ion-icon>
              </ion-button>

             
              <ion-button *ngIf="likes[i] === -1 || likes[i] === 1" class= "buttonLikes" (click)="modificaDislike(risposta.codice_risposta, i)"  slot="end" expand="block" fill = "clear">
                <ion-label slot = "end" class = "textTitleSMALL">{{risposta.num_dislike}}</ion-label>
                <ion-icon name="chevron-down-circle-outline" class="thumb_down_style" slot= "end" ></ion-icon>
              </ion-button>

              <ion-button *ngIf="likes[i] === 2" class= "buttonLikes" (click)="modificaDislike(risposta.codice_risposta, i)"  slot="end" expand="block" fill = "outline">
                <ion-label slot = "end" class = "textTitleSMALL">{{risposta.num_dislike}}</ion-label>
                <ion-icon name="chevron-down-circle-outline" class="thumb_down_style" slot= "end" ></ion-icon>
              </ion-button>

            </ion-toolbar>
          </ion-card-header>
          <ion-card-content >
              <!-- <p class= "textSimple">{{risposta.descrizione}}</p> -->
              <p readonly class= "textSimple" (click)="clickRisposta(risposta, i)">{{risposta.descrizione}}</p>
              <ion-toolbar class="backgrounds">
    
                <ion-icon name="calendar-outline" slot="start" class = "calendar_icon_style" ></ion-icon>
                <ion-label class= "description_text"  slot="start" ></ion-label>
            
              
             <ion-button  *ngIf="currentMailUser === domandaMailUser" (click)="changeColor(risposta.codice_risposta)" slot="end" expand="block" fill = "clear">
            <!--     <ion-icon  class="ribbon_style" *ngIf="risposta.codice_risposta!==cod_preferita" slot="start" slot="icon-only"  name="ribbon" ></ion-icon> -->
                <ion-icon [style.color]="buttonColor" class="ribbon_style_not_pushed" *ngIf="risposta.codice_risposta!==cod_preferita" slot="end" name="ribbon" ></ion-icon>
                <ion-icon [style.color]="buttonColorBest" class="ribbon_style" *ngIf="risposta.codice_risposta===cod_preferita"  slot="end"   name="ribbon"></ion-icon>
              </ion-button>
              <ion-icon [style.color]="buttonColorBest" class="ribbon_style" *ngIf="risposta.codice_risposta===cod_preferita && currentMailUser !== domandaMailUser"  slot="end"   name="ribbon"></ion-icon>
            </ion-toolbar>
              
          </ion-card-content>

          
        </ion-card>
</ion-content>    


<ion-footer *ngIf="rispostaVisible ">  
  <ion-toolbar class="backgroundsSecondaryItem">
    <ion-row style="align-items: center;">
      <ion-col style="padding-inline-start: 10px;" size="10">
        <ion-textarea class="message-input" [(ngModel)]="descrizione_risposta" rows="1" placeholder="Inserisci una risposta">
        </ion-textarea>
      </ion-col>
      <ion-col size="2">
        <ion-button (click)="clickInviaRisposta()" expand="block" fill="clear" [disabled]="testo === ''" class="msg-btn">
          <ion-icon color="primary" name="send-outline" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-col>
    </ion-row>
  </ion-toolbar>
</ion-footer>



